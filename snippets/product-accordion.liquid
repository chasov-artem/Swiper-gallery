{% comment %}
  Dynamic Accordion from Product Metafields
  Metafields needed:
  - accordion_title_1, accordion_content_1
  - accordion_title_2, accordion_content_2  
  - accordion_title_3, accordion_content_3
  - accordion_multiple: true/false for multiple open items
{% endcomment %}

{% assign has_accordion_content = false %}

<!-- Debug: Checking metafields -->
<!-- Debug: Product metafields: {{ product.metafields | json }} -->

{% for i in (1..3) %}
  {% assign title_key = 'accordion_title_' | append: i %}
  {% assign content_key = 'accordion_content_' | append: i %}
  
  {% assign title = product.metafields.custom[title_key] %}
  {% assign content = product.metafields.custom[content_key] %}
  
  {% if title != blank and content != blank %}
    {% assign has_accordion_content = true %}
  {% endif %}
{% endfor %}

{% assign accordion_multiple = product.metafields.custom.accordion_multiple | default: true %}

{% if has_accordion_content %}
  <div class="product-accordion" data-multiple="{{ accordion_multiple }}">
    {% for i in (1..3) %}
      {% assign title_key = 'accordion_title_' | append: i %}
      {% assign content_key = 'accordion_content_' | append: i %}
      
      {% assign title = product.metafields.custom[title_key] %}
      {% assign content = product.metafields.custom[content_key] %}
      
      {% if title != blank and content != blank %}
        <div class="accordion-item">
          <button class="accordion-header" type="button">
            <span class="accordion-title">{{ title }}</span>
            <span class="accordion-icon">+</span>
          </button>
          <div class="accordion-content">
            <div class="accordion-body">
              {{ content }}
            </div>
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
{% else %}
  <!-- Fallback accordion if no metafields are set -->
  <div class="product-accordion" data-multiple="true">
    <div class="accordion-item">
      <button class="accordion-header" type="button">
        <span class="accordion-title">Details</span>
        <span class="accordion-icon">+</span>
      </button>
      <div class="accordion-content">
        <div class="accordion-body">
          Professional formula with vitamin E, long-lasting color, does not wash off during the day
        </div>
      </div>
    </div>
    
    <div class="accordion-item">
      <button class="accordion-header" type="button">
        <span class="accordion-title">Care</span>
        <span class="accordion-icon">+</span>
      </button>
      <div class="accordion-content">
        <div class="accordion-body">
          Store in a cool dry place, close after use
        </div>
      </div>
    </div>
    
    <div class="accordion-item">
      <button class="accordion-header" type="button">
        <span class="accordion-title">Size</span>
        <span class="accordion-icon">+</span>
      </button>
      <div class="accordion-content">
        <div class="accordion-body">
          Standard lipstick size 3.5g, length 8.5cm
        </div>
      </div>
    </div>
  </div>
{% endif %} 